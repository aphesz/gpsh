=== RUN   TestOpenedPhishingEmail
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:37+08:00" level=info msg="Please login with the username admin and the password 3f54cc8e39b32598"
time="2025-12-25T01:54:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:37 +0800] \"GET /track?rid=MdTduRu HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
--- PASS: TestOpenedPhishingEmail (0.40s)
=== RUN   TestReportedPhishingEmail
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:37+08:00" level=info msg="Please login with the username admin and the password cb4ead9e72a751f5"
time="2025-12-25T01:54:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:37 +0800] \"GET /report?rid=yN24N2x HTTP/1.1\" 204 0 \"\" \"Go-http-client/1.1\""
--- PASS: TestReportedPhishingEmail (0.37s)
=== RUN   TestClickedPhishingLinkAfterOpen
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:37+08:00" level=info msg="Please login with the username admin and the password 644071924bb6564c"
time="2025-12-25T01:54:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:37 +0800] \"GET /track?rid=IgSwm1w HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:37 +0800] \"GET /?rid=IgSwm1w HTTP/1.1\" 200 43 \"\" \"Go-http-client/1.1\""
--- PASS: TestClickedPhishingLinkAfterOpen (0.37s)
=== RUN   TestNoRecipientID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:38+08:00" level=info msg="Please login with the username admin and the password cec2e723495c15fc"
time="2025-12-25T01:54:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:38 +0800] \"GET /track HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:38 +0800] \"GET / HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestNoRecipientID (0.36s)
=== RUN   TestInvalidRecipientID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:38+08:00" level=info msg="Please login with the username admin and the password 1477c1e15728a769"
time="2025-12-25T01:54:38+08:00" level=error msg="record not found"
time="2025-12-25T01:54:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:38 +0800] \"GET /track?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:38+08:00" level=error msg="record not found"
time="2025-12-25T01:54:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:38 +0800] \"GET /?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:38+08:00" level=error msg="record not found"
time="2025-12-25T01:54:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:38 +0800] \"GET /report?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidRecipientID (0.37s)
=== RUN   TestCompletedCampaignClick
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:38+08:00" level=info msg="Please login with the username admin and the password 04671457f4cbcc4b"
time="2025-12-25T01:54:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:39 +0800] \"GET /track?rid=BY9I5DK HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:39+08:00" level=info msg="Marking campaign as complete" campaign_id=1
time="2025-12-25T01:54:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:39 +0800] \"GET /track?rid=BY9I5DK HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:39 +0800] \"GET /?rid=BY9I5DK HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestCompletedCampaignClick (0.37s)
=== RUN   TestRobotsHandler
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:39+08:00" level=info msg="Please login with the username admin and the password a4ecb9bac66096a8"
time="2025-12-25T01:54:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:39 +0800] \"GET /robots.txt HTTP/1.1\" 200 26 \"\" \"Go-http-client/1.1\""
--- PASS: TestRobotsHandler (0.36s)
=== RUN   TestInvalidPreviewID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:39+08:00" level=info msg="Please login with the username admin and the password 953acdc485bb24fa"
time="2025-12-25T01:54:39+08:00" level=error msg="record not found"
time="2025-12-25T01:54:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:39 +0800] \"GET /track?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:39+08:00" level=error msg="record not found"
time="2025-12-25T01:54:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:39 +0800] \"GET /?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:39+08:00" level=error msg="record not found"
time="2025-12-25T01:54:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:39 +0800] \"GET /report?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidPreviewID (0.37s)
=== RUN   TestPreviewTrack
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:39+08:00" level=info msg="Please login with the username admin and the password 2cf6d48d6e070fa9"
time="2025-12-25T01:54:40+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:40 +0800] \"GET /track?rid=preview-mEyJfbh HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
--- PASS: TestPreviewTrack (0.37s)
=== RUN   TestPreviewClick
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:40+08:00" level=info msg="Please login with the username admin and the password f653bd47d31b34ac"
time="2025-12-25T01:54:40+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:40 +0800] \"GET /?rid=preview-8Fayt5e HTTP/1.1\" 200 43 \"\" \"Go-http-client/1.1\""
--- PASS: TestPreviewClick (0.37s)
=== RUN   TestInvalidTransparencyRequest
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:40+08:00" level=info msg="Please login with the username admin and the password 18a70e34de6e528c"
time="2025-12-25T01:54:40+08:00" level=error msg="record not found"
time="2025-12-25T01:54:40+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:40 +0800] \"GET /track?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:40+08:00" level=error msg="record not found"
time="2025-12-25T01:54:40+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:40 +0800] \"GET /?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:40+08:00" level=error msg="record not found"
time="2025-12-25T01:54:40+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:40 +0800] \"GET /report?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidTransparencyRequest (0.39s)
=== RUN   TestTransparencyRequest
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:41+08:00" level=info msg="Please login with the username admin and the password 703b29a3a8244396"
time="2025-12-25T01:54:41+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:41 +0800] \"GET /?rid=uYInvPL+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:41+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:41 +0800] \"GET /track?rid=uYInvPL+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:41+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:41 +0800] \"GET /report?rid=uYInvPL+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:41+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:41 +0800] \"GET /?rid=uYInvPL%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:41+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:41 +0800] \"GET /track?rid=uYInvPL%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:41+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:41 +0800] \"GET /report?rid=uYInvPL%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
--- PASS: TestTransparencyRequest (0.38s)
=== RUN   TestRedirectTemplating
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:41+08:00" level=info msg="Please login with the username admin and the password 73763e324a5604f9"
time="2025-12-25T01:54:41+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:41 +0800] \"POST /?rid=tl7iVsI HTTP/1.1\" 302 0 \"\" \"Go-http-client/1.1\""
--- PASS: TestRedirectTemplating (0.37s)
=== RUN   TestLoginCSRF
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:41+08:00" level=info msg="Please login with the username admin and the password 7d1638aac6f4fc03"
time="2025-12-25T01:54:42+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:42 +0800] \"POST /login HTTP/1.1\" 403 33 \"\" \"Go-http-client/1.1\""
--- PASS: TestLoginCSRF (0.37s)
=== RUN   TestInvalidCredentials
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:42+08:00" level=info msg="Please login with the username admin and the password 3748e699156108d2"
time="2025-12-25T01:54:42+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:42 +0800] \"GET /login HTTP/1.1\" 200 1033 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:42+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:42 +0800] \"POST /login HTTP/1.1\" 403 33 \"\" \"Go-http-client/1.1\""
    route_test.go:83: invalid status code received. expected 401 got 403
--- FAIL: TestInvalidCredentials (0.37s)
=== RUN   TestSuccessfulLogin
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:42+08:00" level=info msg="Please login with the username admin and the password b377b1f4214fea11"
time="2025-12-25T01:54:42+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:42 +0800] \"GET /login HTTP/1.1\" 200 1037 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:42+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:42 +0800] \"POST /login HTTP/1.1\" 403 33 \"\" \"Go-http-client/1.1\""
    route_test.go:94: invalid status code received. expected 200 got 403
--- FAIL: TestSuccessfulLogin (0.37s)
=== RUN   TestSuccessfulRedirect
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:42+08:00" level=info msg="Please login with the username admin and the password 34d0c26a379cee0a"
time="2025-12-25T01:54:43+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:43 +0800] \"GET /login HTTP/1.1\" 200 1033 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:43+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:43 +0800] \"POST /login?next=/campaigns HTTP/1.1\" 403 33 \"\" \"Go-http-client/1.1\""
    route_test.go:110: invalid status code received. expected 302 got 403
--- FAIL: TestSuccessfulRedirect (0.37s)
=== RUN   TestAccountLocked
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:54:43+08:00" level=info msg="Please login with the username admin and the password d376ccfcb055c85d"
time="2025-12-25T01:54:43+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:43 +0800] \"GET /login HTTP/1.1\" 200 1030 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:54:43+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:54:43 +0800] \"POST /login HTTP/1.1\" 403 33 \"\" \"Go-http-client/1.1\""
    route_test.go:128: invalid status code received. expected 401 got 403
--- FAIL: TestAccountLocked (0.37s)
FAIL
FAIL	github.com/gophish/gophish/controllers	7.327s
FAIL
