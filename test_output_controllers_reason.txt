=== RUN   TestOpenedPhishingEmail
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:33+08:00" level=info msg="Please login with the username admin and the password 046cd3cf0564e16b"
time="2025-12-25T01:59:33+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:33 +0800] \"GET /track?rid=Z9rTCoV HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
--- PASS: TestOpenedPhishingEmail (0.39s)
=== RUN   TestReportedPhishingEmail
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:33+08:00" level=info msg="Please login with the username admin and the password b8962003355f9910"
time="2025-12-25T01:59:33+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:33 +0800] \"GET /report?rid=HTdlnnT HTTP/1.1\" 204 0 \"\" \"Go-http-client/1.1\""
--- PASS: TestReportedPhishingEmail (0.37s)
=== RUN   TestClickedPhishingLinkAfterOpen
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:33+08:00" level=info msg="Please login with the username admin and the password 4983ee2472d4536e"
time="2025-12-25T01:59:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:34 +0800] \"GET /track?rid=hOjTV9O HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:34 +0800] \"GET /?rid=hOjTV9O HTTP/1.1\" 200 43 \"\" \"Go-http-client/1.1\""
--- PASS: TestClickedPhishingLinkAfterOpen (0.37s)
=== RUN   TestNoRecipientID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:34+08:00" level=info msg="Please login with the username admin and the password f4eee59b34e69181"
time="2025-12-25T01:59:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:34 +0800] \"GET /track HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:34 +0800] \"GET / HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestNoRecipientID (0.37s)
=== RUN   TestInvalidRecipientID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:34+08:00" level=info msg="Please login with the username admin and the password c43d3587d2f9860a"
time="2025-12-25T01:59:34+08:00" level=error msg="record not found"
time="2025-12-25T01:59:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:34 +0800] \"GET /track?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:34+08:00" level=error msg="record not found"
time="2025-12-25T01:59:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:34 +0800] \"GET /?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:34+08:00" level=error msg="record not found"
time="2025-12-25T01:59:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:34 +0800] \"GET /report?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidRecipientID (0.37s)
=== RUN   TestCompletedCampaignClick
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:35+08:00" level=info msg="Please login with the username admin and the password c05430285847ea97"
time="2025-12-25T01:59:35+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:35 +0800] \"GET /track?rid=154FhUM HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:35+08:00" level=info msg="Marking campaign as complete" campaign_id=1
time="2025-12-25T01:59:35+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:35 +0800] \"GET /track?rid=154FhUM HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:35+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:35 +0800] \"GET /?rid=154FhUM HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestCompletedCampaignClick (0.37s)
=== RUN   TestRobotsHandler
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:35+08:00" level=info msg="Please login with the username admin and the password 75c4f84b910ca067"
time="2025-12-25T01:59:35+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:35 +0800] \"GET /robots.txt HTTP/1.1\" 200 26 \"\" \"Go-http-client/1.1\""
--- PASS: TestRobotsHandler (0.36s)
=== RUN   TestInvalidPreviewID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:35+08:00" level=info msg="Please login with the username admin and the password 51e9c9785398634d"
time="2025-12-25T01:59:35+08:00" level=error msg="record not found"
time="2025-12-25T01:59:35+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:35 +0800] \"GET /track?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:35+08:00" level=error msg="record not found"
time="2025-12-25T01:59:35+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:35 +0800] \"GET /?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:35+08:00" level=error msg="record not found"
time="2025-12-25T01:59:35+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:35 +0800] \"GET /report?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidPreviewID (0.37s)
=== RUN   TestPreviewTrack
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:36+08:00" level=info msg="Please login with the username admin and the password 150e81a37f7803f8"
time="2025-12-25T01:59:36+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:36 +0800] \"GET /track?rid=preview-H0ALv7F HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
--- PASS: TestPreviewTrack (0.37s)
=== RUN   TestPreviewClick
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:36+08:00" level=info msg="Please login with the username admin and the password 999c7431d0703f42"
time="2025-12-25T01:59:36+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:36 +0800] \"GET /?rid=preview-m7oTLdC HTTP/1.1\" 200 43 \"\" \"Go-http-client/1.1\""
--- PASS: TestPreviewClick (0.37s)
=== RUN   TestInvalidTransparencyRequest
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:36+08:00" level=info msg="Please login with the username admin and the password 760f2831dbcf84ba"
time="2025-12-25T01:59:37+08:00" level=error msg="record not found"
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /track?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:37+08:00" level=error msg="record not found"
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:37+08:00" level=error msg="record not found"
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /report?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidTransparencyRequest (0.37s)
=== RUN   TestTransparencyRequest
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:37+08:00" level=info msg="Please login with the username admin and the password 3c673a5cd94da221"
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /?rid=0waw7vP+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /track?rid=0waw7vP+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /report?rid=0waw7vP+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /?rid=0waw7vP%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /track?rid=0waw7vP%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"GET /report?rid=0waw7vP%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
--- PASS: TestTransparencyRequest (0.37s)
=== RUN   TestRedirectTemplating
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:37+08:00" level=info msg="Please login with the username admin and the password a8b0620df65b1c41"
time="2025-12-25T01:59:37+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:37 +0800] \"POST /?rid=vknR20C HTTP/1.1\" 302 0 \"\" \"Go-http-client/1.1\""
--- PASS: TestRedirectTemplating (0.38s)
=== RUN   TestLoginCSRF
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:38+08:00" level=info msg="Please login with the username admin and the password fc96d612600511fc"
time="2025-12-25T01:59:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:38 +0800] \"POST /login HTTP/1.1\" 403 33 \"\" \"Go-http-client/1.1\""
--- PASS: TestLoginCSRF (0.37s)
=== RUN   TestInvalidCredentials
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:38+08:00" level=info msg="Please login with the username admin and the password 38951809ff7bb727"
time="2025-12-25T01:59:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:38 +0800] \"GET /login HTTP/1.1\" 200 1037 \"\" \"Go-http-client/1.1\""
Extracted Token: 7mUYNm/ymL+Qz5JUd/HqJnDs7gBCzr8uhlbRocNlIfErK6iDmSFKG1G/DYmhamT/JqdJBftaPuBlwljzAqk+/Q==
Copying cookie: _gorilla_csrf=MTc2NjU5OTE3OHxJbmhWTm5kMFptSlVNSEZVUW1OS0wyUXhjSFZQTWxaYVRIQjNWelZzU1VoUE5EVlRTbFZ6U0UxSWQzYzlJZ289fB6fMBG7ezGD6-zSDqz4iaitY8l_1Zh34AkI2sGuUPg5
Copying cookie: gophish=MTc2NjU5OTE3OHxjblZ5bEx4Rm85LWhLUmthamUzWW15bDV6TFI0U28yVWJ0ZHpJbnByYzhGbWh4cz18KO-nsIMh2sn9HCUFQCPA8tv8Yt3hegAvpRf38DM3kMk=
time="2025-12-25T01:59:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:38 +0800] \"POST /login HTTP/1.1\" 403 28 \"http://127.0.0.1:53516/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:96: invalid status code received. expected 401 got 403
--- FAIL: TestInvalidCredentials (0.37s)
=== RUN   TestSuccessfulLogin
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:38+08:00" level=info msg="Please login with the username admin and the password a386fd443a6ef897"
time="2025-12-25T01:59:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:38 +0800] \"GET /login HTTP/1.1\" 200 1040 \"\" \"Go-http-client/1.1\""
Extracted Token: pzB1zUSZzw8/xFRg47aWsTTf0GE5EVmz6wRGeg1XPaNX43DYdM3KuB2SyGY2D+82ou18hglWKEyrEpcrHYImKA==
Copying cookie: _gorilla_csrf=MTc2NjU5OTE3OHxJamhPVFVaR1ZFSlZRbUpqYVZad2QwY3hZbXcxYURWWmVYSlBZM2RTTTBndlVVSmlVbFZTUkZaSE5ITTlJZ289fAXqrRH-u5-rKqCPappK7LaWl8-WOhNgwbyvcLlwaMxz
Copying cookie: gophish=MTc2NjU5OTE3OHxnR0hNbVlhSFJWelV6RHRRblVJSTVVekRDNENyWnFlSVJwNE1MbHA4UGJxbmRjdz18GJj0YPIlxNJhJg0xjLOgh8svNpkc0UB-h8Rt_TQshh8=
time="2025-12-25T01:59:38+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:38 +0800] \"POST /login HTTP/1.1\" 403 28 \"http://127.0.0.1:53519/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:107: invalid status code received. expected 200 got 403
--- FAIL: TestSuccessfulLogin (0.37s)
=== RUN   TestSuccessfulRedirect
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:39+08:00" level=info msg="Please login with the username admin and the password 1df4a9e25e0e0360"
time="2025-12-25T01:59:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:39 +0800] \"GET /login HTTP/1.1\" 200 1036 \"\" \"Go-http-client/1.1\""
Extracted Token: EjDVjJQLVR0JAKViKoBx/l3o9eMsbSqRb9tgRfP9uKrgx5s3jXiB4IEJGiips87f+pYSFRipd4+0GufwpCO1CQ==
Copying cookie: _gorilla_csrf=MTc2NjU5OTE3OXxJamgyWkU5MWVHeDZNVkF5U1VOaU9VdG5lazh2U1dGa0t6VXZXVEI0UmpCbE1qaEhTSFJXWm1WRVlVMDlJZ289fBCJ4p1nA4AZW-qTgGOGIFL7q8XfxfMkrZo5hFuR4LM6
Copying cookie: gophish=MTc2NjU5OTE3OXxvZ3lMQlF4SkpPVjl4MHBCeU5LeHc4UUlXcE9vOXVQNVBSSHRjdzRXa0tfNDdTdz18iBjH-jZcWSXuaPNnwM3fihv6-FxsGFyLXkAmc9KWTBo=
time="2025-12-25T01:59:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:39 +0800] \"POST /login?next=/campaigns HTTP/1.1\" 403 28 \"http://127.0.0.1:53522/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:123: invalid status code received. expected 302 got 403
--- FAIL: TestSuccessfulRedirect (0.37s)
=== RUN   TestAccountLocked
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T01:59:39+08:00" level=info msg="Please login with the username admin and the password dac6e14f3b6cec28"
time="2025-12-25T01:59:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:39 +0800] \"GET /login HTTP/1.1\" 200 1032 \"\" \"Go-http-client/1.1\""
Extracted Token: H87Op8H4JSQLkoJYFbyk5y5yg01xgiHXx0JY5JtvUyQqcRdtKTChCX8WcnIauPQsZZGeVxxHxgEiPVmsG0wyJA==
Copying cookie: _gorilla_csrf=MTc2NjU5OTE3OXxJazVpTDFwNWRXcEphRU14TUdoUVFYRkVkMUpSZVRCMmFraFNjSFI0WldaWE5WZzRRbE5KUVdwWlVVRTlJZ289fLc3Fr3vQxUbbJ6T7DV_lCM7NBwxaMOxFbWQRJTD7K-l
Copying cookie: gophish=MTc2NjU5OTE3OXxEN2dweUZwM1ZHUlo1VzBRc1NKXzA0dGdpMVdjWkNXbUZtMWVzZDVYNHhtRnRnQT18umDPHxLGJFoajJDSDEzuWvHgK-trCiz38n6MRQRl8Rc=
time="2025-12-25T01:59:39+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:01:59:39 +0800] \"POST /login HTTP/1.1\" 403 28 \"http://127.0.0.1:53525/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:141: invalid status code received. expected 401 got 403
--- FAIL: TestAccountLocked (0.37s)
FAIL
FAIL	github.com/gophish/gophish/controllers	7.222s
FAIL
