=== RUN   TestOpenedPhishingEmail
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:28+08:00" level=info msg="Please login with the username admin and the password c7005e51dbed4833"
time="2025-12-25T02:00:28+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:28 +0800] \"GET /track?rid=0fJos74 HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
--- PASS: TestOpenedPhishingEmail (0.39s)
=== RUN   TestReportedPhishingEmail
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:28+08:00" level=info msg="Please login with the username admin and the password 7099cf05622215f1"
time="2025-12-25T02:00:28+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:28 +0800] \"GET /report?rid=V0lSZB3 HTTP/1.1\" 204 0 \"\" \"Go-http-client/1.1\""
--- PASS: TestReportedPhishingEmail (0.36s)
=== RUN   TestClickedPhishingLinkAfterOpen
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:29+08:00" level=info msg="Please login with the username admin and the password 2a843c0275979e41"
time="2025-12-25T02:00:29+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:29 +0800] \"GET /track?rid=kopSJQW HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:29+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:29 +0800] \"GET /?rid=kopSJQW HTTP/1.1\" 200 43 \"\" \"Go-http-client/1.1\""
--- PASS: TestClickedPhishingLinkAfterOpen (0.37s)
=== RUN   TestNoRecipientID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:29+08:00" level=info msg="Please login with the username admin and the password ff1b28fbbbfd20d9"
time="2025-12-25T02:00:29+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:29 +0800] \"GET /track HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:29+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:29 +0800] \"GET / HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestNoRecipientID (0.36s)
=== RUN   TestInvalidRecipientID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:29+08:00" level=info msg="Please login with the username admin and the password 54af1cfef3c1918a"
time="2025-12-25T02:00:29+08:00" level=error msg="record not found"
time="2025-12-25T02:00:29+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:29 +0800] \"GET /track?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:29+08:00" level=error msg="record not found"
time="2025-12-25T02:00:29+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:29 +0800] \"GET /?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:29+08:00" level=error msg="record not found"
time="2025-12-25T02:00:29+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:29 +0800] \"GET /report?rid=XXXXXXXXXX HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidRecipientID (0.37s)
=== RUN   TestCompletedCampaignClick
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:30+08:00" level=info msg="Please login with the username admin and the password bfffd506d7cbe95b"
time="2025-12-25T02:00:30+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:30 +0800] \"GET /track?rid=V3Ift2C HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:30+08:00" level=info msg="Marking campaign as complete" campaign_id=1
time="2025-12-25T02:00:30+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:30 +0800] \"GET /track?rid=V3Ift2C HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:30+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:30 +0800] \"GET /?rid=V3Ift2C HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestCompletedCampaignClick (0.37s)
=== RUN   TestRobotsHandler
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:30+08:00" level=info msg="Please login with the username admin and the password 6c663c322c2f629c"
time="2025-12-25T02:00:30+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:30 +0800] \"GET /robots.txt HTTP/1.1\" 200 26 \"\" \"Go-http-client/1.1\""
--- PASS: TestRobotsHandler (0.37s)
=== RUN   TestInvalidPreviewID
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:30+08:00" level=info msg="Please login with the username admin and the password 783329eadbbc94dd"
time="2025-12-25T02:00:31+08:00" level=error msg="record not found"
time="2025-12-25T02:00:31+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:31 +0800] \"GET /track?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:31+08:00" level=error msg="record not found"
time="2025-12-25T02:00:31+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:31 +0800] \"GET /?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:31+08:00" level=error msg="record not found"
time="2025-12-25T02:00:31+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:31 +0800] \"GET /report?rid=preview-bogus HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidPreviewID (0.37s)
=== RUN   TestPreviewTrack
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:31+08:00" level=info msg="Please login with the username admin and the password f25b2bca49eb6547"
time="2025-12-25T02:00:31+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:31 +0800] \"GET /track?rid=preview-JvnOtAP HTTP/1.1\" 200 95 \"\" \"Go-http-client/1.1\""
--- PASS: TestPreviewTrack (0.37s)
=== RUN   TestPreviewClick
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:31+08:00" level=info msg="Please login with the username admin and the password 7e1aba09da2c87b0"
time="2025-12-25T02:00:31+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:31 +0800] \"GET /?rid=preview-OKlSFFj HTTP/1.1\" 200 43 \"\" \"Go-http-client/1.1\""
--- PASS: TestPreviewClick (0.37s)
=== RUN   TestInvalidTransparencyRequest
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:31+08:00" level=info msg="Please login with the username admin and the password fd838287d9bec166"
time="2025-12-25T02:00:32+08:00" level=error msg="record not found"
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /track?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:32+08:00" level=error msg="record not found"
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:32+08:00" level=error msg="record not found"
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /report?rid=bogus+ HTTP/1.1\" 404 19 \"\" \"Go-http-client/1.1\""
--- PASS: TestInvalidTransparencyRequest (0.37s)
=== RUN   TestTransparencyRequest
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:32+08:00" level=info msg="Please login with the username admin and the password b4fccd6a1f6a3944"
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /?rid=ZwdE7u2+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /track?rid=ZwdE7u2+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /report?rid=ZwdE7u2+ HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /?rid=ZwdE7u2%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /track?rid=ZwdE7u2%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"GET /report?rid=ZwdE7u2%2b HTTP/1.1\" 200 96 \"\" \"Go-http-client/1.1\""
--- PASS: TestTransparencyRequest (0.37s)
=== RUN   TestRedirectTemplating
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:32+08:00" level=info msg="Please login with the username admin and the password 88a49c921795fb16"
time="2025-12-25T02:00:32+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:32 +0800] \"POST /?rid=gkhL8pO HTTP/1.1\" 302 0 \"\" \"Go-http-client/1.1\""
--- PASS: TestRedirectTemplating (0.37s)
=== RUN   TestLoginCSRF
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:33+08:00" level=info msg="Please login with the username admin and the password 31bd2513c48fa274"
time="2025-12-25T02:00:33+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:33 +0800] \"POST /login HTTP/1.1\" 403 33 \"\" \"Go-http-client/1.1\""
--- PASS: TestLoginCSRF (0.37s)
=== RUN   TestInvalidCredentials
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:33+08:00" level=info msg="Please login with the username admin and the password 1560d8890dbd5a02"
time="2025-12-25T02:00:33+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:33 +0800] \"GET /login HTTP/1.1\" 200 1037 \"\" \"Go-http-client/1.1\""
Extracted Token: tE6OIZU/FeYTFr/yTp+gMMbLHy+oHzNTeOFZVyCzeiF3QV1pFja3sALeF1SodRxz0MfDEIuXQ4RART2nYlD/0w==
Copying cookie: _gorilla_csrf=MTc2NjU5OTIzM3xJbmQzTDFSVFNVMUtiMnhaVW5sTGFXMDFkWEU0VVhoWlRUTkVPR3BwU0VSWVQwdFNhemhGVEdwb1prazlJZ289fK_B_J2EStAdIM5CWQgEN6lDu6gm5QGayB935q96SoxN
Copying cookie: gophish=MTc2NjU5OTIzM3xvOXN1TXgyNDNpVDZyMmdvVGtyZjVMODZlMXoyZDBTSkFsZDBaSTZXdU1qWDZ3cz18VSpzGwC-zr7q6fm63VpYRUBxmqcctNIKg_eyBpU4S9I=
time="2025-12-25T02:00:33+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:33 +0800] \"POST /login HTTP/1.1\" 403 28 \"http://127.0.0.1:53603/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:96: invalid status code received. expected 401 got 403
--- FAIL: TestInvalidCredentials (0.37s)
=== RUN   TestSuccessfulLogin
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:33+08:00" level=info msg="Please login with the username admin and the password c71adabff8228269"
time="2025-12-25T02:00:33+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:33 +0800] \"GET /login HTTP/1.1\" 200 1031 \"\" \"Go-http-client/1.1\""
Extracted Token: uoMBcG68b72XnVbQoV/HeU5HF9jadwwBbQ8BdjJkJ4v8d8k5KcW5eTwzWApUi3mt2tY4aHoMHvnqMYKfgJ7yWA==
Copying cookie: _gorilla_csrf=MTc2NjU5OTIzM3xJbEoyVkVsVFZXUTFNWE5UY25Kbk4yRTVaRk1yTVVwVFVrdzNRMmRsZUV3MGFIbzJSRFppVERZeFpFMDlJZ289fL1vU4PmZNziNYcdY4PMhjAdY5nYyuAgLS2L1oAdfib7
Copying cookie: gophish=MTc2NjU5OTIzM3xJd25seFBEQnBVQm9NcHk3MzNGY1pIN0dYYWxvZ1VrSE9zR25pMVNWTFhCUmQ4ST185Mbr6Ck1OAXOofiG0gs6nWmALwz3InLwszSq0gb9TN8=
time="2025-12-25T02:00:33+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:33 +0800] \"POST /login HTTP/1.1\" 403 28 \"http://127.0.0.1:53607/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:107: invalid status code received. expected 200 got 403
--- FAIL: TestSuccessfulLogin (0.37s)
=== RUN   TestSuccessfulRedirect
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:34+08:00" level=info msg="Please login with the username admin and the password 638a1da97a774502"
time="2025-12-25T02:00:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:34 +0800] \"GET /login HTTP/1.1\" 200 1032 \"\" \"Go-http-client/1.1\""
Extracted Token: E0laLJYvdp9plhXkbJVRIrfcBmst+tcbr9/0UEpprr//PHxeB9Hh1bLxVUisGqB/Pf9AoSnU555AFy/TG138gg==
Copying cookie: _gorilla_csrf=MTc2NjU5OTIzNHxJamRJVlcxamNFZ3JiREJ5WWxvd1EzTjNTUzk0V0ZsdmFsSnpiMFZNYWtOR056aHFZbWN4UlRCVmFqQTlJZ289fNAgbE0VI-b0HIGlySjvP4fsAhiO53qQKOFHI-cAYD9B
Copying cookie: gophish=MTc2NjU5OTIzNHx2VEprZTdMZzlNcmpIZldCUWNXb1BQMXNEUktybXYtZ2M5a3pnRkM4LUdhaXNmcz18QiYGxJBfGwUJbOEB3dGVSisUXsQQ93MhwBtwaf0-8Cc=
time="2025-12-25T02:00:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:34 +0800] \"POST /login?next=/campaigns HTTP/1.1\" 403 28 \"http://127.0.0.1:53611/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:123: invalid status code received. expected 302 got 403
--- FAIL: TestSuccessfulRedirect (0.37s)
=== RUN   TestAccountLocked
/Users/hk/Github/gpsh/controllers
in controllers_test.go: /Users/hk/Github/gpsh/db/db_sqlite3/migrations
goose: migrating db environment 'production', current version: 0, target: 20220321133237
OK    20160118194630_init.sql
OK    20160131153104_0.1.2_add_event_details.sql
OK    20160211211220_0.1.2_add_ignore_cert_errors.sql
OK    20160217211342_0.1.2_create_from_col_results.sql
OK    20160225173824_0.1.2_capture_credentials.sql
OK    20160227180335_0.1.2_store-smtp-settings.sql
OK    20160317214457_0.2_redirect_url.sql
OK    20160605210903_0.2_campaign_scheduling.sql
OK    20170104220731_0.2_result_statuses.sql
OK    20170219122503_0.2.1_email_headers.sql
OK    20170827141312_0.4_utc_dates.sql
OK    20171027213457_0.4.1_maillogs.sql
OK    20171208201932_0.4.1_next_send_date.sql
OK    20180223101813_0.5.1_user_reporting.sql
OK    20180524203752_0.7.0_result_last_modified.sql
OK    20180527213648_0.7.0_store_email_request.sql
OK    20180830215615_0.7.0_send_by_date.sql
OK    20190105192341_0.8.0_rbac.sql
OK    20191104103306_0.9.0_create_webhooks.sql
OK    20200116000000_0.9.0_imap.sql
OK    20200619000000_0.11.0_password_policy.sql
OK    20200730000000_0.11.0_imap_ignore_cert_errors.sql
OK    20200914000000_0.11.0_last_login.sql
OK    20201201000000_0.11.0_account_locked.sql
OK    20220321133237_0.4.1_envelope_sender.sql
time="2025-12-25T02:00:34+08:00" level=info msg="Please login with the username admin and the password 8201d45832e43d90"
time="2025-12-25T02:00:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:34 +0800] \"GET /login HTTP/1.1\" 200 1036 \"\" \"Go-http-client/1.1\""
Extracted Token: eyv7zifVgc8LstnV/yrE6e/klH1zfEEUqTk+W2pHR7s/f+Lh2JJCacGk5nZlLIw2yAm2Mk/4POn6W/6dCioKWA==
Copying cookie: _gorilla_csrf=MTc2NjU5OTIzNHxJbEpHVVZwTUx6bElkelppUzBacUsycHRaMXBKTTNsbWRFbHJPRGhvU0RNNVZUSk1RWGh0UW5SVVpVMDlJZ289fCz0g7Earuf9xKtfeovkTzJDf6Sk-faO5axXX1byCJQp
Copying cookie: gophish=MTc2NjU5OTIzNHxwT3NlRGxjeDVReWFRTnBlWUI3VDlIWDVVSnZDNEFwYVVvNWcxYmxHTi1HN3BBbz18SD1vINzFs7eWqmPW0LCQrt4bhc32Un5ufMcbkxq8ZfQ=
time="2025-12-25T02:00:34+08:00" level=info msg="127.0.0.1 - - [25/Dec/2025:02:00:34 +0800] \"POST /login HTTP/1.1\" 403 28 \"http://127.0.0.1:53615/login\" \"Go-http-client/1.1\""
403 Forbidden Body: Forbidden - referer invalid

    route_test.go:141: invalid status code received. expected 401 got 403
--- FAIL: TestAccountLocked (0.37s)
FAIL
FAIL	github.com/gophish/gophish/controllers	7.325s
FAIL
